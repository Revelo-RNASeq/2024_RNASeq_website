---
format: 
  revealjs:
    navigation-mode: vertical
    slide-number: false
    width: 1600
    height: 900
    logo: "images/revelo.png"
    footer: "[home page](https://revelo-rnaseq.github.io/2024_RNASeq_website)"
    css: ["css/theme.css", "css/custom.css"]
    theme: simple
    controls: true
mainfont: "Times New Roman"
editor: source
filters:
  - roughnotation
editor_options: 
  chunk_output_type: inline
---

##  {#TitleSlide data-menu-title="TitleSlide" background-image="images/back001.jpg" background-size="cover" background-opacity="0.3"}

```{r setup, include=FALSE}
library(fontawesome)
library(tidyverse)
library(quarto)
library(gt)
library(gtExtras)
library(gtsummary)

# font-family: 'Architects Daughter', cursive;
# font-family: 'Julius Sans One', sans-serif;
# font-family: 'Montserrat', san  s-serif;
# font-family: 'Rock Salt', cursive;
```

<style>
  @import url('https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Julius+Sans+One&family=Montserrat:wght@300&family=Rock+Salt&display=swap');
</style>

::: {style="position: absolute; left: 180px; top: 200px; height: 525px; width: 1500px; background-color: #69b1e9; padding: 20px; padding-left: 50px; border-radius: 5px;"}
[Introduzione all'RNASeq]{style="font-size: 120px; font-weight: bold; line-height: 1em; margin: 0px; font-family: 'Architects Daughter', cursive;"}

[Introduzione all'analisi RNASeq in R]{style="font-size: 40px;font-weight: bold;"}

[Dipartimento di Biomedicina e Prevenzione]{style="font-size: 40px;font-weight: bold;"}

<br> <br>

[Marco Chiapello, Revelo Datalab]{style="font-size: 40px; font-weight: bold;"}

[2024-11-18]{style="font-size: 30px;font-weight: bold;"}
:::


<!-- #  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Overview]{.f60 .p-span-center}

:::{.p-img-center}
![](images/pst.jpg){width=1000}
::: -->

#  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

:::{.p-img-center}
![](images/nfcore.png){width=2000}
:::

#  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Pre-processing and Quality Control]{.tit .p-span-center}

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

:::{.p-img-center}
![](images/nfcore.png){width=2000}
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTA file

::: {.callout-important icon="false"}
## Definition

The FASTA format is a text-based format for representing either nucleotide sequences or amino acid sequences. Both nucleotides and amino acids are represented using single-letter codes. The first line before the nucleotide/amino acid sequence contains the name of the sequence, preceded by the ">" symbol.
:::

File extension could be: fasta, fna, ffn, faa, fa, frn

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTA file

::: {.callout-important icon="false"}
## Definition

The FASTA format is a text-based format for representing either nucleotide sequences or amino acid sequences. Both nucleotides and amino acids are represented using single-letter codes. The first line before the nucleotide/amino acid sequence contains the name of the sequence, preceded by the ">" symbol.
:::

    >NM_001404729.1 Oryza sativa ribulose bisphosphate carboxylase small chain A
    CTCAACAGCACTGCTACTGGACATACTCTACTACTACTAGCCAGTAAGCTAGCTAACTAACTACGTGGCT
    ATGGCCCCCACCGTGATGGCCTCCTCGGCCACCTCCGTGGCTCCATTCCAAGGGCTCAANNNNNNNNNNN


##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTA file

Multi-fasta file:

    >MCHU - Calmodulin - Human, rabbit, bovine, rat, and chicken
    MADQLTEEQIAEFKEAFSLFDKDGDGTITTKELGTVMRSLGQNPTEAELQDMINEVDADGNGTID
    FPEFLTMMARKMKDTDSEEEIREAFRVFDKDGNGYISAAELRHVMTNLGEKLTDEEVDEMIREA
    DIDGDGQVNYEEFVQMMTAK

    >NM_001404729.1 Oryza sativa ribulose bisphosphate carboxylase small chain A
    CTCAACAGCACTGCTACTGGACATACTCTACTACTACTAGCCAGTAAGCTAGCTAACTAACTACGTGGCT
    ATGGCCCCCACCGTGATGGCCTCCTCGGCCACCTCCGTGGCTCCATTCCAAGGGCTCAANNNNNNNNNNN
    >HF583486.1 Homo sapiens SOD1 gene for alternative protein SOD1, isolate 144496
    ATGGATTCCATGTTCATGAGTTTGGAGATAATACAGCAGGCTGTACCAGTGCAGGTCCTCACTTTAATCC
    TCTATCCAGAAAACACGGTGGGCCAAAGGATGAAGAGAGGCATGTTGGAGACTTGGGCAATGTGA


##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTQ format

::: {.callout-important icon="false"}
## Definition

The FASTQ format is a text-based format for storing both a biological sequence (usually nucleotide sequence) and its corresponding quality scores. Both the sequence letter and quality score are each encoded with a single ASCII character for brevity.   
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTQ format

::: {.callout-important icon="false"}
## Definition

The FASTQ format is a text-based format for storing both a biological sequence (usually nucleotide sequence) and its corresponding quality scores. Both the sequence letter and quality score are each encoded with a single ASCII character for brevity.   
:::

::: f30
A FASTQ file is identified by 4 lines:

- Line 1: begins with the "@" symbol and is followed by the sequence identifier (as in FASTA sequences)    
- Line 2: contains the nucleotide sequence    
- Line 3: begins with a "+" and may contain additional sequence descriptions    
- Line 4: contains the quality values for the individual nucleotides
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTQ format

::: {.callout-important icon="false"}
## Definition
The FASTQ format is a text-based format for storing both a biological sequence (usually nucleotide sequence) and its corresponding quality scores. Both the sequence letter and quality score are each encoded with a single ASCII character for brevity.   

:::

::: f35
    @SEQ_ID
    GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT
    +
    !''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTQ format

#### What does "quality score" mean?

::: f20
The quality score is used to identify the **probability of the correct identification of the corresponding nucleotide**.
:::

![](images/phred1.png)

::: notes
-   I numeri da 33 a 126 sono i numeri ASCII corrispondenti alla lettera che indicano
-   Score più alto osservato 40, quindi molti si fermano li
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTQ format

#### What does "quality score" mean?

::: f20
The quality score is used to identify the **probability of the correct identification of the corresponding nucleotide**.
:::

::: centerI
![](images/phred2.png){width=900}
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Raw reads: The Starting Point]{.subtit}

### FASTQ format

- FASTQ files can be very large, so in most cases you won't be dealing with myFile.fastq, but with myFile.fastq.gz.

- This means that the file is compressed, so it is not readable by a text editor without first being decompressed.

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

:::{.p-img-center}
![](images/nfcore.png){width=2000}
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Pre-processing Tools]{.subtit}

### FastQC

:::: {.columns}
::: {.column width="60%" .f30}
*   **What it is:** 
    * A widely used tool for quality assessment of raw sequencing data.
*   **What it does:**
    *   Generates comprehensive reports with various quality metrics.
    *   Visualizes data quality using interactive plots and graphs.
*   **Key metrics:**
    *   Per base sequence quality
    *   Per sequence quality scores
    *   Sequence length distribution
    *   GC content
    *   Adapter content
    *   Overrepresented sequences
:::
::: {.column width="30%"}
<br>
<br>
[[FastQC](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/)]{.p-spam.center}
:::
:::: 

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

:::{.p-img-center}
![](images/nfcore.png){width=2000}
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Pre-processing Tools]{.subtit}

### UMI-tools extract

:::: {.columns}
::: {.column width="50%" .f25}
*   **What are UMIs?**
    *   Unique Molecular Identifiers (UMIs) are short random sequences attached to each cDNA molecule during library preparation.
    *   They act as "molecular barcodes" to identify unique molecules.
*   **Why are UMIs important?**
    *   UMIs help to distinguish PCR duplicates from true biological duplicates.
    *   This improves the accuracy of gene expression quantification, especially for low-abundance transcripts.
:::
::: {.column width="50%" .f25}
*   **What does `UMI-tools extract` do?**
    *   Identifies and extracts UMIs from sequencing reads.
    *   Moves UMIs to the read name for downstream analysis.
    *   Requires information about the UMI location in the read.
*   **Benefits:**
    *   Improved accuracy in gene expression quantification.
    *   Reduced bias due to PCR amplification.<br>
<br>
[[UMI-tools](https://umi-tools.readthedocs.io/en/latest/index.html)]{.p-spam.center}
:::
:::: 

:::{.p-img-center}
![](images/umi.png){width=1000}
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

:::{.p-img-center}
![](images/nfcore.png){width=2000}
:::



##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Pre-processing Tools]{.subtit}

### [FastP](https://github.com/OpenGene/fastp) & [Trim Galore!](https://github.com/FelixKrueger/TrimGalore)

:::: {.columns}
::: {.column width="50%" .f30}
*   **Purpose:**  
    * To clean up raw sequencing data and improve the accuracy of downstream analysis.
*   **Key functions:**
    *   **Adapter trimming:**  Remove adapter sequences from reads.
    *   **Quality trimming:**  Trim low-quality bases from the ends of reads.
*   **FastP:**
    *   All-in-one tool with extensive pre-processing features.
    *   Includes quality filtering, error correction, UMI handling, and more.

:::
::: {.column width="50%" .f30}
*   **Trim Galore!:**
    *   Wrapper script for `cutadapt` (adapter trimming) and often includes `FastQC` (quality assessment).
    *   Focuses on adapter and quality trimming with optimized parameters.
*   **Benefits:**
    *   Improved alignment accuracy.
    *   Reduced false positives in variant calling and gene expression analysis.
    *   Increased efficiency of downstream analysis.
:::
:::: 

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

:::{.p-img-center}
![](images/nfcore.png){width=2000}
:::

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Pre-processing Tools]{.subtit}

### BBSplit

:::: {.columns}
::: {.column width="60%" .f30}
*   **What it is:**  
    * A tool for removing contaminant reads from sequencing data.
*   **Types of contamination:**
    *   Microbial DNA or RNA
    *   Host DNA (in the case of RNA-Seq from host-associated samples)
    *   Other unwanted sequences
*   **How it works:**
    *   Aligns reads to a database of contaminant sequences.
    *   Removes reads that map to the contaminant database.

:::
::: {.column width="30%"}
<br>
<br>
[[BBMap](https://sourceforge.net/projects/bbmap/)]{.p-spam.center}
:::
:::: 

##  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Pre-processing Tools]{.subtit}

### SortMeRNA

:::: {.columns}
::: {.column width="60%" .f30}
*   **What it is:**  
    * A tool for filtering ribosomal RNA (rRNA) reads from sequencing data.
*   **Why is it important?**
    *   rRNA often makes up a large proportion of total RNA.
    *   Removing rRNA enriches for mRNA and other non-coding RNAs of interest.
*   **How it works:**
    *   Uses a database of rRNA sequences to identify and remove rRNA reads.
    *   Can be used with both single-end and paired-end data.

:::
::: {.column width="30%"}
<br>
<br>
[[SortMeRNA](https://sortmerna.readthedocs.io/en/latest/)]{.p-spam.center}
:::
:::: 
































#  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Alignment and Quantification]{.tit .p-span-center}


#  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Post-alignment Processing]{.tit .p-span-center}


#  {background-image="images/back001.jpg" background-size="cover" background-opacity="0.1"}

[Downstream Analysis]{.tit .p-span-center}



